import breeze.linalg.DenseVector
import com.hnrklssn.fourinarow.core.model._
import com.hnrklssn.fourinarow.riddles.DependencyFreeNet
import neuroflow.application.plugin.IO
import neuroflow.core.Activator.Sigmoid
import neuroflow.core.{Dense, Input, Network, Output}
import org.scalatest.{FlatSpec, Matchers}
import shapeless.HNil
import neuroflow.core.Activator._
import neuroflow.core._
import neuroflow.nets.DenseNetwork._
import org.scalactic.TolerantNumerics

/**
  * Created by henrik on 2017-08-15.
  */

class DepFreeNetTest  extends FlatSpec with Matchers {
  "A DepFreeNet" should "calculate the same result as a neuroflow net" in {
    val json: String = """[{"rows":42,"cols":25,"data":[0.5188377674688287,0.4159902739573642,-0.23194065211666848,0.17540666663712035,0.3452235347092263,-0.8651298255223252,0.4982822504420015,-0.8943070068558474,0.6304277402153022,-0.6964749054603732,0.06955138697321628,-0.016855546144085132,0.6424947838587283,0.5164489151359029,0.9103183905574397,0.6641871112527933,0.8458451486150356,0.11137589707808226,0.8762286061812243,-0.5216387620582561,-0.9691000894926789,-0.4190534801170782,0.5342225015424029,-0.11874745422493227,-0.37541775849120573,0.04886507537978213,-0.832543834458481,-0.41344751499370025,0.13658835041263306,-0.4968814430315185,0.8267156380855323,0.6787852445376052,-0.14122953514059589,-0.7673599872230885,-0.973554108469973,-0.5470129986166636,0.9694576975510911,-0.7120065083940026,0.6450200810813604,0.15858301620288962,-0.13693188557399405,-0.6350209958229243,-0.3987363951404217,0.838239945435804,0.03943939217695003,0.8172010004948442,0.533906843651939,-0.8840251490275597,0.8849433845633758,0.4643039678967409,0.14729682400488087,-0.40673508291005667,0.23020353189901277,-7.012605962153362E-4,0.32582031100241826,0.111373999360046,-0.06673429151019716,-0.7143798130862091,0.24147414950034674,0.8031907148091804,0.7873883860217068,0.19526737011576012,0.5691239719860639,0.05548956321258425,-0.8892664100162151,-0.7999902502258684,0.6466443936149933,0.520295785013045,0.6401654232129084,-0.9574173161463386,0.5425656680256603,0.043500494664511,0.9252341964878896,-0.2693563349720678,0.8989837229461619,0.989787778084324,0.25434655884280377,0.017516101165089948,-0.323481579631528,0.6058993834365602,-0.6880201188160213,-0.30158096729955686,-0.9873516435450265,0.8470207270257077,0.9825603927591848,0.7151863537377989,0.8981874722173626,0.0013261665747641427,0.18125247876209083,0.8044237755226362,-0.42656387690620434,-0.5768108130448011,0.711587113272677,0.03831101406444315,0.9570594107104944,0.10469205372259172,-0.19126003948026482,-0.11113142714316826,-0.020781545138154556,-0.17660296769768724,0.2048305976876994,-0.34165606386874425,0.4298374138248118,-0.6130029756404438,0.41691490295169853,-0.049497404038049586,0.858350272968248,-0.8736909631002792,0.855563380064813,0.35075210196301554,-0.8504905985846245,-0.0238538761059206,0.7373989210197955,-0.6337098416638629,0.17704213142748726,0.4055787877912882,0.5236212811905367,-0.30756933411165543,-0.2939001285412781,-0.8794473355424672,-0.018357301940162163,0.015588072333090786,0.724351324039699,-0.2381968273533257,0.48968637252302405,0.10535328023393853,0.5673555194395872,0.963317325240084,0.8171471068379637,-0.38272594218624323,0.423508692513769,-0.20236925762233748,0.7466064217751898,-0.46765943242708974,-0.8545674012173845,0.23274084817445528,0.21310138223527142,-0.05778498581662417,0.7074185322037014,0.23554043698121307,-0.45982900490864465,0.08817558956886318,0.6426917724926411,0.7640061655300894,-0.7912978503311789,-0.7830453581025141,-0.2863345579820715,0.8019044840816794,0.07480936112082226,0.19555750377797065,0.9229480192663158,-0.5393573239018254,0.9725652654777468,-0.0023514974902003605,0.7198953091835034,-0.5605769665956892,-0.8522110944971988,-0.4849708654110818,-0.7439344299782349,0.2158826963705427,0.9669975523576078,-0.9217809584829477,0.20555067283522788,0.3031324046620376,0.3513213062015539,0.7578350951983506,-0.05275928553351794,0.10600828053751021,-0.44281209701080604,-0.8481823362668688,-0.9122091999746014,0.3413259923041343,-0.6276865255701942,0.7393303923882351,-0.8218604515654386,0.6973156927499287,0.21106879705326498,0.3342471021947948,0.2744680554679231,-0.20001807269628458,-0.06642843653253849,0.6366103904927072,-0.7076708515040078,-0.8603394173192707,-0.356514411231198,-0.30115546919149794,-0.056642429770002334,-0.5691477762731256,-0.5753593825035881,0.0802205522138868,0.3267274234027373,-0.5371282480784241,0.45190992921998085,0.6876342786698573,-0.8280439927461982,0.8764485058790965,-0.8612912722494497,0.6839177822300997,-0.5241762254885765,-0.2648869517977006,-0.7171801859137743,-0.6384099917633201,0.05630411429859494,-0.2708567674992224,0.7164273699543631,0.2793317348129116,-0.5638942529163933,0.5612881990956045,-0.6221173863731742,-0.3924898881379111,0.27293727850820493,-0.6099294509789459,0.3699666180335257,-0.41333538990621,-0.3205669529875077,0.8528078831422714,-0.6313364522213227,-0.5888406187923887,0.1075759858368528,0.16328742856779765,-0.427915363887573,0.7414558845707877,-0.8205947678377679,0.8903185699928491,0.8945105605544237,0.8152963467495848,0.3405694243869002,-0.07041969756878208,-0.7981221219659056,0.8882686038843559,0.3099235480862219,-0.47189788666319354,-0.2888876965244691,0.8625876282956313,-0.2563530021313356,0.475507454828221,0.6979290514254786,-0.1522755785810206,0.5592302062875143,0.4630157786452276,-0.3903774393738644,0.39690079466778383,-0.029438423637381694,0.4765326202254685,-0.3107012170081751,-0.7805257783412514,0.15314094096530573,-0.6462603723194045,0.2765782540667745,-0.8009107583809125,-0.740312555954761,-0.23411420195713784,-0.9652087291229092,-0.7684119914442269,0.6963377735633178,-0.6855169727474528,0.03528465183949714,-0.16422280606488648,-0.96153090899265,-0.6058888534967797,-0.8500470317606881,-0.013471201718654902,-0.76521313095262,0.9703186659902443,-0.7929825884939616,0.14609235527270248,0.3949924623141603,-0.449632261542809,0.990817671064375,-0.838470601403881,-0.8918617941819131,-0.30516381948747284,0.18572638613882209,-0.5612648458053384,-0.760748595545331,0.7050607941261273,-0.7692450899871519,0.9130495401044088,0.06942342461446782,-0.8947906984218688,0.03176963083012119,-0.7250027344801733,0.7007270483816694,-0.3014485450812219,-0.14878108029447024,-0.23294666440976464,0.9499700452262523,-0.3219522476094243,0.6804302511588176,-0.057651151289394686,0.5899310122740768,0.10601222535910049,-0.6340946973019537,0.44050086409465417,0.9008201292280171,-0.04247366997157842,0.8920607013153079,-0.49278261358139486,-0.5452581926882918,-0.5403243119026444,-0.5445115664486075,0.7600795548046979,0.9545312549276705,-0.8023596751455733,0.9194950202410896,0.9818537194354975,0.22230571364018958,-0.05733675342893929,0.4886184636495241,-0.5410376917825857,0.6538814325586839,0.4019665461504165,0.04491330846102204,-0.5198833448332609,0.10710973867192553,-0.2130727694509149,-0.05736610844396517,0.45891347798824467,0.03920693865600988,0.6972730277037746,0.2295970494425954,0.4567975245894722,-0.7842249767275802,0.1495598008741159,-0.43839912568644457,0.7995529961696668,-0.06361622140480905,-0.17136668217494355,0.8415764600664533,-0.4660314678816282,-0.4815929008129858,-0.4982703521131917,-0.23449961753810578,-0.6714944447725206,-0.7296982716703313,0.08635047308542276,-0.7197703815596395,-0.09165326357698644,0.43946301100077756,-0.4063982240238746,-0.7220913434148837,0.6576981177834811,-0.6662763955136022,-0.23901522819620347,0.06980894019801842,-0.26287689881841514,0.31449511168307454,0.34502499531096564,-0.79412414854767,0.7752909798671643,-0.2572652104952202,0.9560606409657662,-0.5916364447677149,0.9325718643610472,-0.07412403122738098,-0.9944392938920479,-0.48859538563690874,-0.8898346025594284,-0.0908736387130824,0.08271758232134774,-0.04138745861895776,-0.17810546250950998,0.6894499045837368,0.07079764133432165,-0.6243996766733082,0.36218721306526813,-0.7119223766354992,0.5850399074892696,0.45119036434586546,-0.3039612317487552,-0.8042014673335696,-0.7517564961572978,-0.8473945737617479,-0.14787544012257792,0.23992994469926843,0.35157269878780495,0.6181521641874721,0.2083263940379083,-0.053521775772852775,-0.39467588758420846,0.869748828908061,0.283201435157858,0.37506062304882537,0.5512975112912601,-0.3201999739047934,0.5941714588651046,-0.510185976640612,-0.8051382855899045,0.6930335532037939,-0.6537167364421232,-0.3788790915066158,0.9402679957575759,-0.8059763922719947,0.14218365569748226,-0.6755513394313035,-0.004619397063106101,-0.46148334358887255,-0.2031566902541173,0.24047184054425896,-0.4683442211078399,-0.37070652860654585,-0.5678310289376267,0.23967224193937064,0.6031655349424301,0.047995226761804455,0.7606092611363984,-0.8647694695949786,0.913517964497651,-0.4190193852037065,-0.16521920955596592,-0.4309754324545474,-0.13425693501097768,-0.06260188181113069,-0.7193638059235941,0.8492241893429839,0.39386247090284265,-0.2866689142707852,0.4798092943445227,-0.5170548785769244,-0.4096981329082503,0.2146055036616512,-0.1746307635980091,-0.736267381382578,-0.6827365557687812,-0.9898129965367555,0.8671975930377991,0.6401146619018834,-0.7473547137756216,-0.7515448343553381,-0.6417156955240073,-0.6520261879445381,-0.7863156912666922,0.6339547382623392,0.613861835026152,-0.5595019261588317,-0.6596504359835325,0.5187991813608703,0.38048511182967437,0.9899639942498013,-0.05146174350151966,0.16552232817160095,0.4055908917551394,0.13477811243121685,0.7359995655907519,0.08121931338315247,0.5453739727947153,0.9385593942756187,-0.8223480826377356,-0.6831915639829254,0.8119930976575163,-0.7031291068988597,0.7240851240611794,0.2672029402331577,0.4931905126672149,0.7340349792780829,-0.3069244857482589,-0.5548754607525921,-0.5417996793076172,0.7011959222994435,-0.33580165904676784,-0.8672929734472721,0.07558613385375423,-0.12105335751156487,-0.4357122642862501,-0.41505173967452014,0.22686147424706404,-0.33169638642348276,-0.5908168972116117,-0.1690610772408614,-0.469788491857674,-0.5408176421558446,0.9554067112860556,0.26738809864968616,-0.4567569032712262,0.890695910422169,-0.6675232088498384,0.01825819663554551,0.94915078707279,-0.8797098330806918,0.8262876178604326,0.13288793887786854,0.5368527542898078,0.3771072623028522,0.8268937634753091,0.9794688389466946,-0.35879988519539685,-0.5809593136263318,-0.8998120844976241,0.5209744508383314,-0.6870651525002864,-0.26532947098917936,0.8096134901823291,-0.20787387838164384,0.6275036426521037,-0.16380477055477094,0.15047354755234355,-0.9383341714255276,-0.4540960394833735,0.3766464450749343,-0.2798606447247003,-0.7816766620215703,0.5244666825285944,-0.1508719142824706,0.3795372608466461,0.18001877915252984,-0.7358538455716404,-0.375841279646963,-0.6997668366073067,-0.7734154931532633,-0.05769112077348848,0.2325454222001011,0.8036510689932488,0.5824548012948756,0.7097171087419796,-0.6717818847757537,0.8942131008688479,0.5173306383653762,-0.7966346933511816,0.5315655465069509,-0.668846617759131,0.72693797985384,-0.5533680200412381,0.18111303086219377,-0.018713924455080688,-0.8536997537804305,-0.5611201921336335,0.9917938008614715,0.8445530912478858,-0.6298274580325838,-0.9432308291632836,0.49067162105283635,-0.5488941605541309,-0.1595609274102019,0.8168983302984081,0.7692458442596453,-0.9742294133378611,0.27573589871858517,0.8969416328738113,0.7922670348464866,-0.9197768015380616,0.838134742082443,-0.6983194163701767,-0.3188634167911073,-0.3709769593471337,0.0688741424019168,0.5075667731185334,-0.9845527433082066,0.4358162368139684,-0.050742093446319414,-0.1884711619242012,-0.5537062299769266,-0.5676988554293629,-0.22993324866758647,-0.10995507347181377,0.8960359030063514,-0.45368401512265155,-0.6800458942348906,-0.9133890198367045,-0.24471337178543928,-0.6013803162202629,-0.7061942219947228,0.4606231718549241,0.5770563819689591,0.8082804312757892,-0.6334873630974074,-0.6235963359770078,0.7067414877575251,-0.9771303628727062,0.27931717429208835,0.3265146854899772,-0.591606768951382,0.9081930412647916,-0.6331737279326268,0.3524803508200596,-0.31701040495285704,0.4561214654623609,-0.009753168578036542,0.9362884414503296,0.4045951403445187,0.5806072875470307,-0.37656355778572626,-0.7046862566334726,-0.6085952189133654,-0.7547335637303871,-0.4680438387991608,-0.47533150990581907,0.7648030977632976,0.1230482088356617,0.9945610245560315,-0.21893680500531354,-0.8754719493452792,-0.7185637515295009,-0.6975594100910096,0.8052044658139703,0.3293017301043246,-0.9273519804261992,-0.8716049734708922,0.9873985666283702,-0.27548217068923586,-0.8022823714160816,0.14892655602481608,0.5645247914240465,0.7981875947569519,-0.9207040202785528,0.4275122321028437,-0.21427846381600824,-0.6538500705504771,-0.6708734684811437,-0.08860217055583464,-0.3059675636169943,-0.7998476717478165,0.1627426389139892,-0.7629614701518936,-0.8592473065230488,-0.12166838034976069,0.8246909811610321,0.25446555027879114,-0.27860685215045367,-0.1940699842091842,-0.6227387800519839,0.7641130532902365,0.6925744504040958,0.8136118141301294,-0.0629118931054562,0.9871220619750509,0.23711726910791664,-0.6595369802507327,-0.08544821713346074,0.23273925993022426,0.3754369786113607,0.4972905434139254,0.4868149810374811,-0.19314372938629898,-0.3282762436867861,-0.035571891770112885,-0.5108921860380984,-0.1739654208511181,-0.28226402430363007,0.3399735433767368,0.14720054892237244,-0.23245655001467602,-0.627656867261976,-0.3405777208549128,-0.5411252951636238,0.3500099489543773,-0.5847093428602455,-0.9657487858780025,-0.696627294927517,0.06704472886159141,-0.49815016943214885,0.48086367783598716,0.08279356070732269,0.7449303871046795,-0.9567159210742249,0.1912073929548581,-0.035246668291993855,-0.24423002879268663,-0.9166395459915206,0.6111379484022854,-0.6770481761287888,-0.9176630805354846,0.12852591646779565,0.3971689390651214,0.28533173543266854,0.45709836428926565,-0.14236467346228854,-0.7166980782904082,-0.7886696213071731,0.419670308647923,-0.7280748340765906,-0.08162334662081183,0.46304223782174736,0.8913788965242113,0.18846532328701393,-0.653489580371641,-0.14947154360807358,-0.7947151491801496,0.6678705977701875,-0.06298078886211567,0.6309709172725575,0.6209488122610103,-0.9823870758312077,-0.023570678392214273,0.4336658810710412,-0.3637883710317842,0.7913065728609836,-0.3488320023766811,-0.48970867731959045,-0.0773888830768974,-0.7770014723008065,0.32676176128553136,-0.9274158164769362,-0.9786048167397641,-0.8292851300509871,-0.39276595421678984,-0.9427643697928827,-0.29828770749646916,-0.4969481205646027,0.6768998160462454,0.34464216985264584,0.06940624758764957,-0.5310111574202199,-0.7035614567112192,0.8578848736185662,0.1486553487936504,-0.8914505404276711,0.5649555373644959,0.39095419464038894,0.9830885102104905,-0.9728450924789249,0.5758469118139216,0.7007304313219682,0.10029880099236421,-0.23316618675955336,0.6785474164763661,-0.5410554877383147,0.8674865036365433,-0.6693382127325156,-0.06209535518743725,-0.16318595043476414,0.638633566741303,-0.6737158909537608,0.3427589337672887,-0.1423893249096213,0.6929684616154033,-0.020188801841615422,0.857001460317802,0.05073014371585827,0.6445187532529206,-0.3125298661525431,-0.9548520707542172,-0.6205115355267479,0.2125219104741889,-0.8703227236164774,-0.539588300023315,-0.2738018519499452,-0.6126658874256314,0.20172356420534832,0.3984134278082061,0.9581257647843215,0.03053329635554025,-0.7430166310474962,-0.7630280317989755,0.3293525906572048,-0.6810248900915143,-0.021694049701424856,-0.3639036048794997,0.12145403697255452,0.44770200908865987,-0.025112638327589032,0.7669239090741062,-0.3610123815956383,0.7077091803792328,0.5771376294095598,0.8135454175832799,0.23542455184731148,0.05716782540397114,-0.6470090114540232,-0.26203885617356937,-0.6692999627607736,0.6556380267476287,-0.9289978815130933,0.0761277621226113,-0.9410629412966283,-0.8167865735211097,-0.012182943322771589,0.7779673358161234,-0.6719725647435792,-0.24629193605515187,0.46970518797409855,0.40657288664688696,-0.03870059341570187,-0.23697742406693223,0.48480918203506485,0.4599449680613603,-0.6510727480855545,0.7629306614109428,0.463822421510214,0.1716021553550835,-0.4814432502436754,0.5298289535827563,-0.35464033386866545,0.26884665829463317,-0.5209351698263995,-0.1076797603655073,-0.41301967284372654,-0.7724763271014137,0.6386409715284134,0.8954112716592497,0.3312360862311392,-0.38461214836015367,0.5554587687483548,-0.3278246682116426,-0.5583137409078722,-0.23638572351539588,0.5380749388374133,0.036432055075616976,-0.6654298749174077,-0.9367132485838707,0.34345280732706884,-0.21293696639509085,0.43979320127154153,-0.4410134121422338,0.06465937523237963,0.5660191378984614,0.06522752987876457,0.35417023501301315,-0.671300156069865,0.7249997701275754,0.480896367042279,0.4227806383556272,-0.42161714745589385,0.038602005816281926,0.5301751806994623,0.4088735960341947,-0.8649915814067115,-0.9893577968322957,-0.6207483033648604,0.6650881155537507,-0.9968808055049345,-0.8120125629613482,-0.4713285252534798,0.24416849719675526,-0.6396189996438013,-0.16074364896447602,0.96075903771302,-0.4742167704756721,-0.7484776338776167,0.8290806522220819,0.1584975333131724,-0.2610574250688358,0.8090510944910874,-0.9227709166394782,0.7728502195364164,-0.21431906369027165,0.9114283477465932,0.6569139039728875,0.7927685922163592,0.6449389698431482,0.150165441148576,-0.6361291090054764,-0.4670929560145449,-0.12770445599618907,0.45393346315576744,-0.05175459017810735,0.19761026827447736,-0.1812940131731391,0.9648859979632374,-0.861236458135167,0.24069625152760032,-0.40852617563592264,0.7942790087369538,-0.04513210845784976,-0.7301597344208488,0.3142113811154561,0.9176238076339349,-0.9275477680065323,0.42938924001228784,0.43508930459109085,-0.16074091179457684,0.7506200987691876,-0.8235072219195103,-0.8041565983735142,0.8176037601803074,-0.9356256290815557,0.31982287922937336,0.16981963831016178,-0.9311035792749771,0.44914717624210376,0.8138879463638429,-0.23961877556087274,-0.9320133703604221,-0.3283034403975176,0.9272988540897791,-0.47465800232897437,0.1056117212209502,0.49271563493611037,0.9773957911511777,-3.5138848801730127E-4,-0.5842100277980402,-0.9616801887678703,0.7413219490735445,-0.7715513039162245,0.30027677127285757,0.7119740827350525,0.044788138629674235,-0.28112853322838194,-0.43744306100090635,-0.4527595695683604,0.9623308730703133,-0.1397631539201487,-0.06648576256518268,-0.0548212525716385,0.2949281025656705,0.034350484409314985,0.15518699768373634,-0.2360034109167719,-0.062108196955971806,0.18124046811031458,0.9155166468960267,-0.2738844931801159,0.4914410241314844,0.7133526428707442,-0.025141276920734867,-0.0324395086034015,-0.7660813076406989,-0.6748458908747308,0.625357707779935,-0.29615727034198325,0.2437340224486848,-0.9688827533794382,0.8775887267543407,0.5244586954278894,-0.1940982349396181,0.7070002387475445,0.2604764281826215,0.3968486923031975,0.5046466482210983,-0.27296778869451965,-0.07234458867363158,-0.28359312855308705,0.29849004810650714,-0.30795987352306975,-0.9776956382430935,0.419053950581308,0.2247538680886838,-0.4173572721773524,-0.8215312080599786,-0.9027785691188315,-0.012588532601088165,0.36027303936112576,-0.13152079773544711,-0.0754612087123947,0.13113730171597737,0.06057687196097028,-0.22807005592474705,-0.3867140275818124,-0.4115672774722625,-0.955771278600172,0.8500770707505618,-0.9072003402829276,-0.05639187139047985,-0.24124134900884187,0.873206296470542,0.31675106451866664,0.9214472731949066,-0.5031155998573122,0.231157057561854,0.17568830227538412,-0.689149026535461,-0.65738074456354,-0.6791723239644272,0.39165714026390375,-0.4296106789241314,-0.5732889258103859,0.015315464563349535,-0.6897259101534405,0.2928047437261787,0.25694753741592113,-0.16425486712013915,-0.12446033266721845,0.620849637682046,-0.7802558889312579,-0.6756249788136721,0.30363267986220666,-0.08672617244166703,0.09301635094929983,-0.9244320621734539,0.6597109132481795,0.21135203302336958,0.5242323102701139,-0.11499834416680432,0.2606119455015361,-0.0397449154278402,-0.9387518068355125,0.5971349849552419,0.28063445860333647,-0.9226489763830075,0.7295569987348052,-0.6740420340862232,-0.44578379179045413,0.6553477898982709,-0.8092148954229277,0.6940922022646321,0.4315171738353569,-0.714674511225696,-0.4884608141945346,0.9610903830495643,0.043144527973956626,-0.5573250101132039,-0.2853771327623005,0.047026773480373096,0.5763287486332442,-0.6200173882623121,-0.4321780817170444,-0.6955408925056088,0.8513179502371788,0.3285758693049383,0.31876421034469704,0.21032305797330064,0.7275451774700077,0.47751414770048983,0.9440943934135402,0.7842714626292577,-0.7658391883145192,-0.2184945733153394,-0.8402758160028949,0.04216769167203327,-0.05588512975004445,-0.2460259239937055,-0.06919538921417967,-0.07135751339936425,-0.23076462341470427,-0.06089344287622289,0.4863285289014925,-0.05481070984725278,-0.7623760778477615,-0.5125516746903598,0.9508381072475214,-0.22102205531099361,0.24732453346028604,0.202326503973276,-0.5664465729838826,-0.861832336610137,0.5317856879958496,-0.7521632444585211,-0.0732219460243273,0.42454472008509625,-0.22366796483708096,-0.5530387014824578,-0.2606944496910317,-0.8028044074961462,-0.6007724957549716,0.6896629501839382,0.18916020522172317,-0.8445212316141326,-0.2982162879925865,-0.3645847195962888,-0.18407984112681142,-0.7597826629071802,-0.041778776779225035,0.40306386605691946,0.8959465612655604,-0.11867661892641368,-0.40538071556175126,0.5640857291935664,0.04328761840040318,-0.44376898236753437,-0.6512606425184244,-0.5082067249306537]},{"rows":25,"cols":1,"data":[0.8702132761145971,0.625752574598307,-0.30214664608678854,0.8186488918970032,0.05538013721796098,0.8726790334482288,-0.6599674347444946,0.754809666698546,-0.6535813721280224,-0.7260961076002017,-0.5083476049019107,-0.8969090323900297,0.6102575315874676,-0.8452823259698035,0.459789414848234,0.7361865397884928,-0.5603076412037002,0.0753986389160568,-0.016699565428888175,0.3732434297948486,-0.23819139380829313,0.7810158384465156,-0.7336211787321161,-0.3032549122690438,-0.6542140589049468]}]"""
    val f = Sigmoid
    val layers = Input(42) :: Dense(25, f) :: Output(1, f) :: HNil
    implicit val weights  = IO.Json.read(json)
    val neuroflowNet = Network(layers)
    val depFreeNet = DependencyFreeNet(json, f.apply)
    val input = 0.0 until 42.0 by 1.0
    implicit val doubleEquality = TolerantNumerics.tolerantDoubleEquality(0.0001)
    neuroflowNet(DenseVector(input.toArray))(0) should equal(depFreeNet(input.toVector)(0))
  }

  it should "parse a layer of weights" in {
    val input = """"rows":25,"cols":1,"data":[0.8702132761145971,0.625752574598307,-0.30214664608678854,0.8186488918970032,0.05538013721796098,0.8726790334482288,-0.6599674347444946,0.754809666698546,-0.6535813721280224,-0.7260961076002017,-0.5083476049019107,-0.8969090323900297,0.6102575315874676,-0.8452823259698035,0.459789414848234,0.7361865397884928,-0.5603076412037002,0.0753986389160568,-0.016699565428888175,0.3732434297948486,-0.23819139380829313,0.7810158384465156,-0.7336211787321161,-0.3032549122690438,-0.6542140589049468]}]"""
    DependencyFreeNet.parseLayer(input) should equal(Vector(Vector(0.8702132761145971,0.625752574598307,-0.30214664608678854,0.8186488918970032,0.05538013721796098,0.8726790334482288,-0.6599674347444946,0.754809666698546,-0.6535813721280224,-0.7260961076002017,-0.5083476049019107,-0.8969090323900297,0.6102575315874676,-0.8452823259698035,0.459789414848234,0.7361865397884928,-0.5603076412037002,0.0753986389160568,-0.016699565428888175,0.3732434297948486,-0.23819139380829313,0.7810158384465156,-0.7336211787321161,-0.3032549122690438,-0.6542140589049468)))
  }

}
